<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TIMBRE QR</title>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.10.3/dist/cdn.min.js" defer></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="telegramBot.js" defer></script>
</head>
<body class="flex items-center justify-center h-screen bg-gray-100">
    <div x-data="telegramBot()" x-init="initialize" class="text-center">
        <button 
            x-bind:disabled="!locationGranted || locationSent" 
            @click="sendLocation" 
            class="px-8 py-4 bg-blue-500 text-white text-xl font-bold rounded-lg disabled:opacity-50 disabled:cursor-not-allowed">
            Tocar Timbre
        </button>
        <template x-if="mediaRecorderSupported">
            <div>
                <button 
                    x-bind:disabled="!locationGranted || isRecording" 
                    @click="startRecording" 
                    class="px-8 py-4 bg-green-500 text-white text-xl font-bold rounded-lg disabled:opacity-50 disabled:cursor-not-allowed mt-4">
                    Grabar Mensaje
                </button>
                <button 
                    x-show="isRecording" 
                    @click="stopRecording" 
                    class="px-8 py-4 bg-red-500 text-white text-xl font-bold rounded-lg disabled:opacity-50 disabled:cursor-not-allowed mt-4">
                    Detener Grabación
                </button>
            </div>
        </template>
        <audio x-show="audioUrl" x-bind:src="audioUrl" controls class="mt-4"></audio>
        <p x-show="locationSent" class="mt-4 text-green-500">Notificación enviada</p>
        <p x-show="locationDenied" class="mt-4 text-red-500">Permisos de geolocalización no concedidos</p>
        <template x-if="countdown > 0">
            <p class="mt-4 text-gray-500" x-text="'Puedes presionar nuevamente en ' + countdown + ' segundos'"></p>
        </template>
    </div>
</body>
</html>
